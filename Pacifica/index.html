<!--
  this code is in the public domain, but the images may be copyrighted
-->
<html>
<head>
<title>Pacifica</title>
<link rel="stylesheet" type="text/css" href="../main.css">
<script src="Pacifica.js" language="JavaScript"></script>
<script src="layouts.js" language="JavaScript"></script>
<script src="tiles.js" language="JavaScript"></script>
<style>
canvas {
  background-image: url('../images/bg0.jpeg');
}
</style>
</head>
<body>
<center>
<canvas>Game Board</canvas>
<form id="game-controls">
<p>Layout: 
<select id="select-layout" width="120" style="width: 120px;">
  <option>Random</option>
  <option>Turtle</option>
  <option>Arena</option>
  <option>Mombasa</option>
  <option>Mombasa 2</option>
</select>
<input type="submit" id="submit-button" value="New Board"/>
</form>
</p>
<script language="JavaScript">
// preload images
const numImages = 36;
for (let i = 1; i <= numImages; i++) {
  document.write(`<img src="tiles/tile${i}.jpg" width="0" height="0"/>`);
}
window.onload = function () {
  const width = window.innerWidth;
  const height = window.innerHeight;
  console.log(`${width}x${height}`);
  const canvas = document.querySelector("canvas");
  const canvasWidth = Math.min(width - 50, 1600);
  const canvasHeight = Math.min(width / 1.6 - 80, 1000);
  console.log(`${canvasWidth}x${canvasHeight}`);
  canvas.width = canvasWidth;
  canvas.height = canvasHeight;
  const imageSize = canvasWidth / 16;
  const renderer = new Renderer(imageSize);
  const layouts = get_layouts();
  const selCtrl = document.getElementById("select-layout");
  function random_layout() {
    return layouts[Math.floor(Math.random()*layouts.length)];
  };
  function onSelect(evt) {
    if (evt !== null && evt.preventDefault !== undefined) evt.preventDefault();
    const idx = selCtrl.selectedIndex;
    const layout = (idx === 0) ? random_layout() : layouts[idx - 1];
    make_board(layout.tiles, imageSize, renderer);
    return false;
  };
  const form = document.getElementById('game-controls');
  if (form.attachEvent) {
    form.attachEvent("submit", onSelect);
  } else {
    form.addEventListener("submit", onSelect);
  }
  selCtrl.addEventListener("onchange", onSelect);
  onSelect(null);
  //make_board(layout.tiles, imageSize, renderer);
}
</script>
<p><font class="note">All source code and backgrounds are my original work, but I do not own the copyright to all of the tile images.</font></p>
<p><font class="note"><a href="editor.html">Prototype Unicode tile editor</a></font></p>
</center>
</body>
</html>
